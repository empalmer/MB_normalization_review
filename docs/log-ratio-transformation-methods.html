<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Log Ratio Transformation Methods | Tutorial on Normalization of Microbiome Data</title>
  <meta name="description" content="A tutorial on normalization methods for microbiome data and discussion of thier uses and performance" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Log Ratio Transformation Methods | Tutorial on Normalization of Microbiome Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A tutorial on normalization methods for microbiome data and discussion of thier uses and performance" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Log Ratio Transformation Methods | Tutorial on Normalization of Microbiome Data" />
  
  <meta name="twitter:description" content="A tutorial on normalization methods for microbiome data and discussion of thier uses and performance" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="wrench.html"/>
<link rel="next" href="comparisions.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MB Normalization</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-importance-of-normalization"><i class="fa fa-check"></i><b>1.1</b> The importance of normalization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-compositional-nature-of-microbiome-data"><i class="fa fa-check"></i><b>1.2</b> The compositional nature of microbiome data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>2</b> Importing Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="importing-data.html"><a href="importing-data.html#global-patterns"><i class="fa fa-check"></i><b>2.1</b> Global Patterns</a></li>
<li class="chapter" data-level="2.2" data-path="importing-data.html"><a href="importing-data.html#colorectal-cancer"><i class="fa fa-check"></i><b>2.2</b> Colorectal cancer</a></li>
<li class="chapter" data-level="2.3" data-path="importing-data.html"><a href="importing-data.html#pre-processing-quality-control-and-filtering"><i class="fa fa-check"></i><b>2.3</b> Pre-processing Quality Control and Filtering</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="count-scaling-normalization-methods.html"><a href="count-scaling-normalization-methods.html"><i class="fa fa-check"></i><b>3</b> Count Scaling Normalization methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="count-scaling-normalization-methods.html"><a href="count-scaling-normalization-methods.html#total-sum-scaling-tss"><i class="fa fa-check"></i><b>3.1</b> Total Sum scaling (TSS)</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="count-scaling-normalization-methods.html"><a href="count-scaling-normalization-methods.html#about-tss"><i class="fa fa-check"></i><b>3.1.1</b> About TSS</a></li>
<li class="chapter" data-level="3.1.2" data-path="count-scaling-normalization-methods.html"><a href="count-scaling-normalization-methods.html#tss-r-code"><i class="fa fa-check"></i><b>3.1.2</b> TSS R code</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="count-scaling-normalization-methods.html"><a href="count-scaling-normalization-methods.html#cumulative-sum-scaling-css"><i class="fa fa-check"></i><b>3.2</b> Cumulative sum scaling (CSS)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="count-scaling-normalization-methods.html"><a href="count-scaling-normalization-methods.html#about-css"><i class="fa fa-check"></i><b>3.2.1</b> About CSS</a></li>
<li class="chapter" data-level="3.2.2" data-path="count-scaling-normalization-methods.html"><a href="count-scaling-normalization-methods.html#css-r-code"><i class="fa fa-check"></i><b>3.2.2</b> CSS R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subsampling-methods.html"><a href="subsampling-methods.html"><i class="fa fa-check"></i><b>4</b> Subsampling Methods</a>
<ul>
<li class="chapter" data-level="4.1" data-path="subsampling-methods.html"><a href="subsampling-methods.html#rarefying"><i class="fa fa-check"></i><b>4.1</b> Rarefying</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="subsampling-methods.html"><a href="subsampling-methods.html#about-rarefying"><i class="fa fa-check"></i><b>4.1.1</b> About Rarefying</a></li>
<li class="chapter" data-level="4.1.2" data-path="subsampling-methods.html"><a href="subsampling-methods.html#rarefying-walkthrough"><i class="fa fa-check"></i><b>4.1.2</b> Rarefying walkthrough</a></li>
<li class="chapter" data-level="4.1.3" data-path="subsampling-methods.html"><a href="subsampling-methods.html#rarefying-r-code"><i class="fa fa-check"></i><b>4.1.3</b> Rarefying R code</a></li>
<li class="chapter" data-level="4.1.4" data-path="subsampling-methods.html"><a href="subsampling-methods.html#rarefying-on-kostic-data"><i class="fa fa-check"></i><b>4.1.4</b> Rarefying on Kostic Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html"><i class="fa fa-check"></i><b>5</b> Library Size and Composition Scaling Methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#deseq"><i class="fa fa-check"></i><b>5.1</b> DESeq</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#about-deseq"><i class="fa fa-check"></i><b>5.1.1</b> About DESeq</a></li>
<li class="chapter" data-level="5.1.2" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#deseq-r-code"><i class="fa fa-check"></i><b>5.1.2</b> DESeq R Code</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#gmpr"><i class="fa fa-check"></i><b>5.2</b> GMPR</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#about-gmpr"><i class="fa fa-check"></i><b>5.2.1</b> About GMPR</a></li>
<li class="chapter" data-level="5.2.2" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#gmpr-walkthough"><i class="fa fa-check"></i><b>5.2.2</b> GMPR Walkthough</a></li>
<li class="chapter" data-level="5.2.3" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#gmpr-r-code"><i class="fa fa-check"></i><b>5.2.3</b> GMPR R Code</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#tmm-edger"><i class="fa fa-check"></i><b>5.3</b> TMM (edgeR)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#about-tmm"><i class="fa fa-check"></i><b>5.3.1</b> About TMM</a></li>
<li class="chapter" data-level="5.3.2" data-path="library-size-and-composition-scaling-methods.html"><a href="library-size-and-composition-scaling-methods.html#edger-tmm-t-code"><i class="fa fa-check"></i><b>5.3.2</b> EdgeR TMM T code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrench.html"><a href="wrench.html"><i class="fa fa-check"></i><b>6</b> Wrench</a></li>
<li class="chapter" data-level="7" data-path="log-ratio-transformation-methods.html"><a href="log-ratio-transformation-methods.html"><i class="fa fa-check"></i><b>7</b> Log Ratio Transformation Methods</a>
<ul>
<li class="chapter" data-level="7.1" data-path="log-ratio-transformation-methods.html"><a href="log-ratio-transformation-methods.html#ancom-ii"><i class="fa fa-check"></i><b>7.1</b> ANCOM II</a></li>
<li class="chapter" data-level="7.2" data-path="log-ratio-transformation-methods.html"><a href="log-ratio-transformation-methods.html#ancom-bc"><i class="fa fa-check"></i><b>7.2</b> ANCOM BC</a></li>
<li class="chapter" data-level="7.3" data-path="log-ratio-transformation-methods.html"><a href="log-ratio-transformation-methods.html#aldex2"><i class="fa fa-check"></i><b>7.3</b> ALDEx2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="comparisions.html"><a href="comparisions.html"><i class="fa fa-check"></i><b>8</b> Comparisions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorial on Normalization of Microbiome Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="log-ratio-transformation-methods" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Log Ratio Transformation Methods</h1>
<p>The log-ratio based methodology developed by Aitchison in the 1980s is useful for analyzing compositional data <span class="citation">(Aitchison <a href="#ref-aitchison1982" role="doc-biblioref">1982</a>)</span>. Taking the logarithm of ratios can be an appropriate transformation for compositional data, so standard statistical tests can be appropriate again. This transformation removes the issue of standardizing/normalizing different sampling depths. The sampling depth for a given sample will not distort the biological covariance or correlation structure.</p>
<p>This log-ratio method has a drawback, which is the decision of how to define the denominator. One approach to this problem is to use one sample as the reference. This sample should be ‘representative’. The log-ratio transformation is then the ratio of every other taxon to that representative sample. Of course, knowledge of what makes a sample representative is hard to come by and often unknown, and subsequent results can be affected by this choice. This method is frequently called the additive log-ratio approach (alr). The alternative approach is to use the data to create a pseudo-reference sample. This pseudo-reference sample is the geometric mean of the counts of all taxa. This is called the centered log-ratio method.</p>
<p>While promising, these log-ratio methods have drawbacks in practice. Microbiome data are often incredibly sparse, with up to 80-90% of count matrices containing zero counts. For ratio transformations, if we have sparse data, the geometric mean can be zero. Then the ratio is undefined, and further, so is the logarithm of zero count taxa.</p>
<p>One solution to this is adding a small pseudo count to every element in the data. This removes problems occurring from having zero counts in the data, but there is not a clear best choice of what pseudo count to use, and it the choice can impact downstream results.</p>
<div id="ancom-ii" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> ANCOM II</h2>
<p>ANCOM-II <span class="citation">(Kaul et al. <a href="#ref-kaul2017" role="doc-biblioref">2017</a>)</span> is a log-ratio approach for accounting for zero-inflation in log-ratio transformations. It uses a log-ratio transformation instead of library size normalization. If there are <span class="math inline">\(m\)</span> total taxa, this method performs <span class="math inline">\(m-1\)</span> differential abundance tests, each one using a different taxa as the reference taxa. Before the alr log-ratio transformation is performed, this method identifies and adjusts for three types of zeros that can exist. These three types of zeros are outlier zeros, structural zeros, and sampling zeros. Outlier zeros are zeros caused from some extraneous reasons separate from below detection limits due to sampling depth. To account for these zeros, they are replaced by NA in the data. Secondly, structural zeros are zeros which are zero due to the nature of the groups. If a taxa is structurally zero in a group, it is marked as automatically differentially abundant, and removed from further analysis. Finally, sampling zeros are other zeros that are zero perhaps caused by sampling depth. These are imputed by a small pseudocount. This method thus takes into account zero-inflation and compositionality. <!-- After this process, no numerical zeros remain, so log and log-ratio transformations can be performed. This method thus takes into account zero-inflation and compositionality.  --></p>
<p>After this correction of zeros, the data are log ratio transformed using each possible taxa as the reference sample. Tests for differential abundance are performed on each of iterations of the log-ratio transformed data, and the count of times the resulting test is significant is used to determining overall significance.</p>
<!-- This method is shown to be conservative,  -->
<!-- Sensitive, good control of FDR -->
<p>It is possible that no outlier or structural zeros are detected, so as a normalization/transformation technique, this method can be equivalent to alr or clr transoformation on raw data with a pseudocount.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="log-ratio-transformation-methods.html#cb71-1"></a><span class="co">## Load the Ancom function (it&#39;s not a package)</span></span>
<span id="cb71-2"><a href="log-ratio-transformation-methods.html#cb71-2"></a>devtools<span class="op">::</span><span class="kw">source_url</span>(<span class="st">&quot;https://raw.githubusercontent.com/FrederickHuangLin/ANCOM/master/scripts/ancom_v2.1.R&quot;</span>)</span>
<span id="cb71-3"><a href="log-ratio-transformation-methods.html#cb71-3"></a></span>
<span id="cb71-4"><a href="log-ratio-transformation-methods.html#cb71-4"></a>norm_ANCOM2 &lt;-<span class="st"> </span><span class="cf">function</span>(ps, group_var, <span class="dt">outlier.replace =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb71-5"><a href="log-ratio-transformation-methods.html#cb71-5"></a>    feature_table &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">otu_table</span>(ps))</span>
<span id="cb71-6"><a href="log-ratio-transformation-methods.html#cb71-6"></a>    groups &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">get_variable</span>(ps, group_var))</span>
<span id="cb71-7"><a href="log-ratio-transformation-methods.html#cb71-7"></a>    meta_data &lt;-</span>
<span id="cb71-8"><a href="log-ratio-transformation-methods.html#cb71-8"></a><span class="st">        </span><span class="kw">data.frame</span>(<span class="dt">sample_id =</span> <span class="kw">paste0</span>(<span class="st">&quot;sample&quot;</span>, <span class="kw">seq</span>(<span class="kw">dim</span>(raw)[<span class="dv">2</span>])), <span class="dt">groups =</span> groups)</span>
<span id="cb71-9"><a href="log-ratio-transformation-methods.html#cb71-9"></a>    <span class="co">#rownames(meta_data) &lt;- meta_data$sample_id</span></span>
<span id="cb71-10"><a href="log-ratio-transformation-methods.html#cb71-10"></a>    <span class="kw">colnames</span>(feature_table) &lt;-<span class="st"> </span>meta_data<span class="op">$</span>sample_id</span>
<span id="cb71-11"><a href="log-ratio-transformation-methods.html#cb71-11"></a>    </span>
<span id="cb71-12"><a href="log-ratio-transformation-methods.html#cb71-12"></a>    <span class="co"># The main ANCOM2 zero-classification function </span></span>
<span id="cb71-13"><a href="log-ratio-transformation-methods.html#cb71-13"></a>    prepro &lt;-</span>
<span id="cb71-14"><a href="log-ratio-transformation-methods.html#cb71-14"></a><span class="st">        </span><span class="kw">feature_table_pre_process</span>(</span>
<span id="cb71-15"><a href="log-ratio-transformation-methods.html#cb71-15"></a>            feature_table,</span>
<span id="cb71-16"><a href="log-ratio-transformation-methods.html#cb71-16"></a>            meta_data,</span>
<span id="cb71-17"><a href="log-ratio-transformation-methods.html#cb71-17"></a>            <span class="dt">sample_var =</span> <span class="st">&quot;sample_id&quot;</span>,</span>
<span id="cb71-18"><a href="log-ratio-transformation-methods.html#cb71-18"></a>            <span class="dt">group_var =</span> <span class="st">&quot;groups&quot;</span>,</span>
<span id="cb71-19"><a href="log-ratio-transformation-methods.html#cb71-19"></a>            <span class="dt">out_cut =</span> <span class="fl">0.05</span>,</span>
<span id="cb71-20"><a href="log-ratio-transformation-methods.html#cb71-20"></a>            <span class="dt">zero_cut =</span> <span class="fl">0.9</span>,</span>
<span id="cb71-21"><a href="log-ratio-transformation-methods.html#cb71-21"></a>            <span class="dt">lib_cut =</span> <span class="dv">0</span>,</span>
<span id="cb71-22"><a href="log-ratio-transformation-methods.html#cb71-22"></a>            <span class="dt">neg_lb =</span> <span class="ot">FALSE</span></span>
<span id="cb71-23"><a href="log-ratio-transformation-methods.html#cb71-23"></a>        )</span>
<span id="cb71-24"><a href="log-ratio-transformation-methods.html#cb71-24"></a>    feature_table &lt;-<span class="st"> </span>prepro<span class="op">$</span>feature_table</span>
<span id="cb71-25"><a href="log-ratio-transformation-methods.html#cb71-25"></a>    meta_data &lt;-<span class="st"> </span>prepro<span class="op">$</span>meta_data</span>
<span id="cb71-26"><a href="log-ratio-transformation-methods.html#cb71-26"></a>    struc_zero &lt;-<span class="st"> </span>prepro<span class="op">$</span>structure_zeros</span>
<span id="cb71-27"><a href="log-ratio-transformation-methods.html#cb71-27"></a>    </span>
<span id="cb71-28"><a href="log-ratio-transformation-methods.html#cb71-28"></a>    <span class="co"># OTU table transformation:</span></span>
<span id="cb71-29"><a href="log-ratio-transformation-methods.html#cb71-29"></a>    <span class="co"># (1) Discard taxa with structural zeros (if any); (2) Add pseudocount (1) and take logarithm.</span></span>
<span id="cb71-30"><a href="log-ratio-transformation-methods.html#cb71-30"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(struc_zero)) {</span>
<span id="cb71-31"><a href="log-ratio-transformation-methods.html#cb71-31"></a>        num_struc_zero =<span class="st"> </span><span class="kw">apply</span>(struc_zero, <span class="dv">1</span>, sum)</span>
<span id="cb71-32"><a href="log-ratio-transformation-methods.html#cb71-32"></a>        comp_table =<span class="st"> </span>feature_table[num_struc_zero <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,]</span>
<span id="cb71-33"><a href="log-ratio-transformation-methods.html#cb71-33"></a>    } <span class="cf">else</span>{</span>
<span id="cb71-34"><a href="log-ratio-transformation-methods.html#cb71-34"></a>        comp_table =<span class="st"> </span>feature_table</span>
<span id="cb71-35"><a href="log-ratio-transformation-methods.html#cb71-35"></a>    }</span>
<span id="cb71-36"><a href="log-ratio-transformation-methods.html#cb71-36"></a>    comp_table &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">as.matrix</span>(comp_table) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb71-37"><a href="log-ratio-transformation-methods.html#cb71-37"></a>    </span>
<span id="cb71-38"><a href="log-ratio-transformation-methods.html#cb71-38"></a>    <span class="co"># Replace outlier zeros with the mean of the rest genes in each</span></span>
<span id="cb71-39"><a href="log-ratio-transformation-methods.html#cb71-39"></a>    <span class="cf">if</span> (outlier.replace) {</span>
<span id="cb71-40"><a href="log-ratio-transformation-methods.html#cb71-40"></a>        <span class="cf">for</span> (col <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(comp_table)) {</span>
<span id="cb71-41"><a href="log-ratio-transformation-methods.html#cb71-41"></a>            comp_table[<span class="kw">is.na</span>(comp_table[, col]), col] &lt;-</span>
<span id="cb71-42"><a href="log-ratio-transformation-methods.html#cb71-42"></a><span class="st">                </span><span class="kw">mean</span>(comp_table[, col], <span class="dt">na.rm =</span> T)</span>
<span id="cb71-43"><a href="log-ratio-transformation-methods.html#cb71-43"></a>        }</span>
<span id="cb71-44"><a href="log-ratio-transformation-methods.html#cb71-44"></a>    }</span>
<span id="cb71-45"><a href="log-ratio-transformation-methods.html#cb71-45"></a>    <span class="co"># Calculate ratio</span></span>
<span id="cb71-46"><a href="log-ratio-transformation-methods.html#cb71-46"></a>    n_taxa &lt;-<span class="st"> </span><span class="kw">dim</span>(comp_table)[<span class="dv">1</span>]</span>
<span id="cb71-47"><a href="log-ratio-transformation-methods.html#cb71-47"></a>    taxa_id &lt;-<span class="st"> </span><span class="kw">rownames</span>(comp_table)</span>
<span id="cb71-48"><a href="log-ratio-transformation-methods.html#cb71-48"></a>    n_samp &lt;-<span class="st"> </span><span class="kw">dim</span>(comp_table)[<span class="dv">2</span>]</span>
<span id="cb71-49"><a href="log-ratio-transformation-methods.html#cb71-49"></a>    log_geo_mean &lt;-</span>
<span id="cb71-50"><a href="log-ratio-transformation-methods.html#cb71-50"></a><span class="st">        </span><span class="kw">apply</span>(comp_table, <span class="dv">2</span>, <span class="cf">function</span>(x) {</span>
<span id="cb71-51"><a href="log-ratio-transformation-methods.html#cb71-51"></a>            <span class="kw">mean</span>(x, <span class="dt">na.rm =</span> T)</span>
<span id="cb71-52"><a href="log-ratio-transformation-methods.html#cb71-52"></a>        })</span>
<span id="cb71-53"><a href="log-ratio-transformation-methods.html#cb71-53"></a>    mu_group_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(log_geo_mean[groups <span class="op">==</span><span class="st"> </span><span class="kw">levels</span>(groups)[<span class="dv">1</span>]])</span>
<span id="cb71-54"><a href="log-ratio-transformation-methods.html#cb71-54"></a>    mu_group_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(log_geo_mean[groups <span class="op">==</span><span class="st"> </span><span class="kw">levels</span>(groups)[<span class="dv">2</span>]])</span>
<span id="cb71-55"><a href="log-ratio-transformation-methods.html#cb71-55"></a>    mu &lt;-<span class="st"> </span><span class="kw">rep</span>(mu_group_<span class="dv">1</span>, n_samp)</span>
<span id="cb71-56"><a href="log-ratio-transformation-methods.html#cb71-56"></a>    mu[groups <span class="op">==</span><span class="st"> </span><span class="kw">levels</span>(groups)[<span class="dv">2</span>]] &lt;-<span class="st"> </span>mu_group_<span class="dv">2</span></span>
<span id="cb71-57"><a href="log-ratio-transformation-methods.html#cb71-57"></a>    bias &lt;-<span class="st"> </span>log_geo_mean <span class="op">-</span><span class="st"> </span>mu</span>
<span id="cb71-58"><a href="log-ratio-transformation-methods.html#cb71-58"></a>    dat.normed &lt;-</span>
<span id="cb71-59"><a href="log-ratio-transformation-methods.html#cb71-59"></a><span class="st">        </span>comp_table <span class="op">-</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(bias, n_taxa), <span class="dt">nrow =</span> n_taxa, <span class="dt">byrow =</span> T)</span>
<span id="cb71-60"><a href="log-ratio-transformation-methods.html#cb71-60"></a>    <span class="kw">colnames</span>(dat.normed) &lt;-<span class="st"> </span><span class="kw">colnames</span>(raw)</span>
<span id="cb71-61"><a href="log-ratio-transformation-methods.html#cb71-61"></a>    </span>
<span id="cb71-62"><a href="log-ratio-transformation-methods.html#cb71-62"></a>    </span>
<span id="cb71-63"><a href="log-ratio-transformation-methods.html#cb71-63"></a>    <span class="co"># Convert to phyloseq</span></span>
<span id="cb71-64"><a href="log-ratio-transformation-methods.html#cb71-64"></a>    otu &lt;-<span class="st"> </span><span class="kw">otu_table</span>(dat.normed, <span class="dt">taxa_are_rows =</span> T)</span>
<span id="cb71-65"><a href="log-ratio-transformation-methods.html#cb71-65"></a>    sam &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;sam_data&quot;</span>)</span>
<span id="cb71-66"><a href="log-ratio-transformation-methods.html#cb71-66"></a>    sam<span class="op">$</span>scaling_factor &lt;-<span class="st"> </span><span class="kw">exp</span>(bias)</span>
<span id="cb71-67"><a href="log-ratio-transformation-methods.html#cb71-67"></a>    tax &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;tax_table&quot;</span>)</span>
<span id="cb71-68"><a href="log-ratio-transformation-methods.html#cb71-68"></a>    phy &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;phy_tree&quot;</span>)</span>
<span id="cb71-69"><a href="log-ratio-transformation-methods.html#cb71-69"></a>    ps_ancom2 &lt;-<span class="st"> </span><span class="kw">phyloseq</span>(otu, sam, tax, phy)</span>
<span id="cb71-70"><a href="log-ratio-transformation-methods.html#cb71-70"></a>    <span class="kw">return</span>(ps_ancom2)</span>
<span id="cb71-71"><a href="log-ratio-transformation-methods.html#cb71-71"></a>}</span>
<span id="cb71-72"><a href="log-ratio-transformation-methods.html#cb71-72"></a></span>
<span id="cb71-73"><a href="log-ratio-transformation-methods.html#cb71-73"></a></span>
<span id="cb71-74"><a href="log-ratio-transformation-methods.html#cb71-74"></a>k_ancom2 &lt;-<span class="st"> </span><span class="kw">norm_ANCOM2</span>(k_raw, <span class="st">&quot;DIAGNOSIS&quot;</span>)</span>
<span id="cb71-75"><a href="log-ratio-transformation-methods.html#cb71-75"></a>k_ancom2</span></code></pre></div>
</div>
<div id="ancom-bc" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> ANCOM BC</h2>
<p>ANCOM BC <span class="citation">(Lin and Peddada <a href="#ref-lin2020" role="doc-biblioref">2020</a>)</span> includes a normalization method that accounts for zero inflation and compositionality.</p>
<p>This method corrects bias by estimating a sampling fraction, which is…. It accounts for sampling fraction by introducing a sample-specific offset in a linear regression framework, estimated form observed data. The offset term is the bias correction, and the linear regression in log scale is analogous to the log ratio transformation to deal with compositionality.</p>
<p>This method also identifies and accounts for outlier zeros, structural zeros, and sampling zeros, using the same methodology as ANCOM2.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="log-ratio-transformation-methods.html#cb72-1"></a><span class="kw">library</span>(ANCOMBC)</span>
<span id="cb72-2"><a href="log-ratio-transformation-methods.html#cb72-2"></a>norm_ANCOMBC &lt;-<span class="st"> </span><span class="cf">function</span>(ps, group_var) {</span>
<span id="cb72-3"><a href="log-ratio-transformation-methods.html#cb72-3"></a>    out =<span class="st"> </span><span class="kw">ancombc</span>(ps,</span>
<span id="cb72-4"><a href="log-ratio-transformation-methods.html#cb72-4"></a>                  <span class="dt">formula =</span> group_var,</span>
<span id="cb72-5"><a href="log-ratio-transformation-methods.html#cb72-5"></a>                  <span class="dt">group =</span> group_var,</span>
<span id="cb72-6"><a href="log-ratio-transformation-methods.html#cb72-6"></a>                  <span class="dt">struc_zero =</span> T, </span>
<span id="cb72-7"><a href="log-ratio-transformation-methods.html#cb72-7"></a>                  <span class="dt">neg_lb =</span> T, </span>
<span id="cb72-8"><a href="log-ratio-transformation-methods.html#cb72-8"></a>                  <span class="dt">zero_cut =</span> <span class="fl">.9</span>)</span>
<span id="cb72-9"><a href="log-ratio-transformation-methods.html#cb72-9"></a>    <span class="co">#it is recommended to set neg_lb = TRUE when the sample size per group is relatively large (e.g. &gt; 30)</span></span>
<span id="cb72-10"><a href="log-ratio-transformation-methods.html#cb72-10"></a>    sampling.fraction &lt;-<span class="st"> </span><span class="kw">exp</span>(out<span class="op">$</span>samp_frac)</span>
<span id="cb72-11"><a href="log-ratio-transformation-methods.html#cb72-11"></a>    <span class="co"># Normalize counts</span></span>
<span id="cb72-12"><a href="log-ratio-transformation-methods.html#cb72-12"></a>    <span class="co"># feature_table &lt;- otu_table(ps, taxa_are_rows = T)</span></span>
<span id="cb72-13"><a href="log-ratio-transformation-methods.html#cb72-13"></a>    feature_table &lt;-<span class="st"> </span>out<span class="op">$</span>feature_table</span>
<span id="cb72-14"><a href="log-ratio-transformation-methods.html#cb72-14"></a>    <span class="co"># otu_norm &lt;- t(t(otu) / sampling.fraction)</span></span>
<span id="cb72-15"><a href="log-ratio-transformation-methods.html#cb72-15"></a>    otu_norm &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">t</span>(feature_table) <span class="op">/</span><span class="st"> </span>sampling.fraction)</span>
<span id="cb72-16"><a href="log-ratio-transformation-methods.html#cb72-16"></a>    otu &lt;-<span class="st"> </span><span class="kw">otu_table</span>(otu_norm, T)</span>
<span id="cb72-17"><a href="log-ratio-transformation-methods.html#cb72-17"></a>    sam &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;sam_data&quot;</span>)</span>
<span id="cb72-18"><a href="log-ratio-transformation-methods.html#cb72-18"></a>    sam<span class="op">$</span>scaling_factor &lt;-<span class="st"> </span>sampling.fraction</span>
<span id="cb72-19"><a href="log-ratio-transformation-methods.html#cb72-19"></a>    tax &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;tax_table&quot;</span>)</span>
<span id="cb72-20"><a href="log-ratio-transformation-methods.html#cb72-20"></a>    phy &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;phy_tree&quot;</span>)</span>
<span id="cb72-21"><a href="log-ratio-transformation-methods.html#cb72-21"></a>    ps_ancombc &lt;-<span class="st"> </span><span class="kw">phyloseq</span>(otu, sam, tax, phy)</span>
<span id="cb72-22"><a href="log-ratio-transformation-methods.html#cb72-22"></a>    <span class="kw">return</span>(ps_ancombc)</span>
<span id="cb72-23"><a href="log-ratio-transformation-methods.html#cb72-23"></a>}</span>
<span id="cb72-24"><a href="log-ratio-transformation-methods.html#cb72-24"></a></span>
<span id="cb72-25"><a href="log-ratio-transformation-methods.html#cb72-25"></a>k_ancombc &lt;-<span class="st"> </span><span class="kw">norm_ANCOMBC</span>(k_raw, <span class="dt">group_var =</span> <span class="st">&quot;DIAGNOSIS&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in data_prep(phyloseq, group, zero_cut, lib_cut, global = global):
## The multi-group comparison will be deactivated as the group variable has &lt; 3
## categories.</code></pre>
</div>
<div id="aldex2" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> ALDEx2</h2>
<!-- https://www.bioconductor.org/packages/devel/bioc/vignettes/ALDEx2/inst/doc/ALDEx2_vignette.html -->
<p>ALDEx2 <span class="citation">(Fernandes et al. <a href="#ref-fernandes2014" role="doc-biblioref">2014</a>)</span> is a method for differential abundance analysis developed for use with microbiome or any other sequencing setting. It uses a clr log-ratio transformation instead of library size normalization. To deal with sparsity, it creates randomized instances via Monte Carlo draws based on Dirichlet-Multinomial distribution with probabilities from the raw count data, These are zero-free, so log-ratio transformations are possible.</p>
<p>The idea is to estimate biological and sampling variation to calculate expected false discovery rate given variation. The method estimates technical variation within each sample using MC draws from Dirichlet distribution. For differential abundance, statistical tests are performed on each instance, p-values averaged, then corrected for multiple comparisons This method has been shown to be conservative compared to many of the library size normalization methods.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="log-ratio-transformation-methods.html#cb74-1"></a><span class="kw">library</span>(ALDEx2)</span>
<span id="cb74-2"><a href="log-ratio-transformation-methods.html#cb74-2"></a>norm_ALDEx2 &lt;-<span class="st"> </span><span class="cf">function</span>(ps, group_var) {</span>
<span id="cb74-3"><a href="log-ratio-transformation-methods.html#cb74-3"></a>    raw &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">otu_table</span>(ps))</span>
<span id="cb74-4"><a href="log-ratio-transformation-methods.html#cb74-4"></a>    groups &lt;-<span class="st"> </span><span class="kw">get_variable</span>(ps, group_var)</span>
<span id="cb74-5"><a href="log-ratio-transformation-methods.html#cb74-5"></a>    <span class="co"># Run ALDEx2 function</span></span>
<span id="cb74-6"><a href="log-ratio-transformation-methods.html#cb74-6"></a>    aldex.clr.res &lt;-</span>
<span id="cb74-7"><a href="log-ratio-transformation-methods.html#cb74-7"></a><span class="st">        </span><span class="kw">aldex.clr</span>(</span>
<span id="cb74-8"><a href="log-ratio-transformation-methods.html#cb74-8"></a>            <span class="dt">reads =</span> raw,</span>
<span id="cb74-9"><a href="log-ratio-transformation-methods.html#cb74-9"></a>            <span class="dt">conds =</span> groups,</span>
<span id="cb74-10"><a href="log-ratio-transformation-methods.html#cb74-10"></a>            <span class="dt">mc.samples =</span> <span class="dv">128</span></span>
<span id="cb74-11"><a href="log-ratio-transformation-methods.html#cb74-11"></a>        )</span>
<span id="cb74-12"><a href="log-ratio-transformation-methods.html#cb74-12"></a>    <span class="co"># Extract each clr MC draw</span></span>
<span id="cb74-13"><a href="log-ratio-transformation-methods.html#cb74-13"></a>    mc_draws &lt;-<span class="st"> </span><span class="kw">getMonteCarloInstances</span>(aldex.clr.res)</span>
<span id="cb74-14"><a href="log-ratio-transformation-methods.html#cb74-14"></a></span>
<span id="cb74-15"><a href="log-ratio-transformation-methods.html#cb74-15"></a>    <span class="co"># Average each draw for the &#39;normalized&#39; clr read table</span></span>
<span id="cb74-16"><a href="log-ratio-transformation-methods.html#cb74-16"></a>    dat.normed &lt;-</span>
<span id="cb74-17"><a href="log-ratio-transformation-methods.html#cb74-17"></a><span class="st">        </span><span class="kw">matrix</span>(<span class="dv">0</span>,</span>
<span id="cb74-18"><a href="log-ratio-transformation-methods.html#cb74-18"></a>               <span class="dt">nrow =</span> <span class="kw">nrow</span>(mc_draws[[<span class="dv">1</span>]]) ,</span>
<span id="cb74-19"><a href="log-ratio-transformation-methods.html#cb74-19"></a>               <span class="dt">ncol =</span> <span class="kw">length</span>(mc_draws))</span>
<span id="cb74-20"><a href="log-ratio-transformation-methods.html#cb74-20"></a>    <span class="cf">for</span> (col <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(dat.normed)) {</span>
<span id="cb74-21"><a href="log-ratio-transformation-methods.html#cb74-21"></a>        dat.normed[, col] &lt;-<span class="st"> </span><span class="kw">apply</span>(mc_draws[[col]], <span class="dv">1</span>, mean)</span>
<span id="cb74-22"><a href="log-ratio-transformation-methods.html#cb74-22"></a>    }</span>
<span id="cb74-23"><a href="log-ratio-transformation-methods.html#cb74-23"></a>    <span class="kw">rownames</span>(dat.normed) &lt;-<span class="st"> </span><span class="kw">rownames</span>(mc_draws[[<span class="dv">1</span>]])</span>
<span id="cb74-24"><a href="log-ratio-transformation-methods.html#cb74-24"></a>    <span class="kw">colnames</span>(dat.normed) &lt;-<span class="st"> </span><span class="kw">names</span>(mc_draws)</span>
<span id="cb74-25"><a href="log-ratio-transformation-methods.html#cb74-25"></a>    </span>
<span id="cb74-26"><a href="log-ratio-transformation-methods.html#cb74-26"></a>    otu &lt;-<span class="st"> </span><span class="kw">otu_table</span>(dat.normed, T)</span>
<span id="cb74-27"><a href="log-ratio-transformation-methods.html#cb74-27"></a>    sam &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;sam_data&quot;</span>)</span>
<span id="cb74-28"><a href="log-ratio-transformation-methods.html#cb74-28"></a>    tax &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;tax_table&quot;</span>)</span>
<span id="cb74-29"><a href="log-ratio-transformation-methods.html#cb74-29"></a>    phy &lt;-<span class="st"> </span><span class="kw">access</span>(ps, <span class="st">&quot;phy_tree&quot;</span>)</span>
<span id="cb74-30"><a href="log-ratio-transformation-methods.html#cb74-30"></a>    ps_aldex2 &lt;-<span class="st"> </span><span class="kw">phyloseq</span>(otu, sam, tax, phy)</span>
<span id="cb74-31"><a href="log-ratio-transformation-methods.html#cb74-31"></a>    <span class="kw">return</span>(ps_aldex2)</span>
<span id="cb74-32"><a href="log-ratio-transformation-methods.html#cb74-32"></a>}</span>
<span id="cb74-33"><a href="log-ratio-transformation-methods.html#cb74-33"></a></span>
<span id="cb74-34"><a href="log-ratio-transformation-methods.html#cb74-34"></a>k_aldex2 &lt;-<span class="st"> </span><span class="kw">norm_ALDEx2</span>(k_raw, <span class="dt">group_var =</span> <span class="st">&quot;DIAGNOSIS&quot;</span>)</span></code></pre></div>
<pre><code>## operating in serial mode</code></pre>
<pre><code>## computing center with all features</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references hanging-indent">
<div id="ref-aitchison1982">
<p>Aitchison, J. 1982. “The Statistical Analysis of Compositional Data.” <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 44 (2): 139–60. <a href="https://doi.org/10.1111/j.2517-6161.1982.tb01195.x">https://doi.org/10.1111/j.2517-6161.1982.tb01195.x</a>.</p>
</div>
<div id="ref-fernandes2014">
<p>Fernandes, Andrew D, Jennifer NS Reid, Jean M Macklaim, Thomas A McMurrough, David R Edgell, and Gregory B Gloor. 2014. “Unifying the Analysis of High-Throughput Sequencing Datasets: Characterizing Rna-Seq, 16S rRNA Gene Sequencing and Selective Growth Experiments by Compositional Data Analysis.” <em>Microbiome</em> 2 (May): 15. <a href="https://doi.org/10.1186/2049-2618-2-15">https://doi.org/10.1186/2049-2618-2-15</a>.</p>
</div>
<div id="ref-kaul2017">
<p>Kaul, Abhishek, Siddhartha Mandal, Ori Davidov, and Shyamal D. Peddada. 2017. “Analysis of Microbiome Data in the Presence of Excess Zeros.” <em>Frontiers in Microbiology</em> 0. <a href="https://doi.org/10.3389/fmicb.2017.02114">https://doi.org/10.3389/fmicb.2017.02114</a>.</p>
</div>
<div id="ref-lin2020">
<p>Lin, Huang, and Shyamal Das Peddada. 2020. “Analysis of Compositions of Microbiomes with Bias Correction.” <em>Nature Communications</em> 11 (1): 3514. <a href="https://doi.org/10.1038/s41467-020-17041-7">https://doi.org/10.1038/s41467-020-17041-7</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="wrench.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparisions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MB_normalization_review.pdf", "MB_normalization_review.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
